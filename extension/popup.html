<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>CopiMon</title>
    <style>
      :root { --brand:#3b82f6; --bg:#f8fafc; --text:#0f172a; --muted:#64748b; --card:#ffffff; --border:#e2e8f0; --success:#16a34a; --warn:#f59e0b; --danger:#ef4444; }
      body { font-family: system-ui, Arial, sans-serif; margin: 0; padding: 0; width: 400px; background: var(--bg); color: var(--text); }
      header { display:flex; align-items:center; justify-content:space-between; padding:12px; background:var(--card); border-bottom:1px solid var(--border); position:sticky; top:0; z-index:1; }
      h1 { font-size: 16px; margin: 0; color: var(--text); font-weight: 600; }
      .toolbar { display:flex; gap:6px; }
      .row { display: flex; gap: 6px; margin: 10px 12px; align-items: center; }
      input[type="text"] { flex: 1; padding: 8px; border:1px solid var(--border); border-radius:6px; background: #fff; font-size: 13px; }
      button { padding: 8px 12px; border:1px solid var(--border); background:#fff; border-radius:6px; cursor:pointer; font-size: 13px; }
      button:hover { background: #f1f5f9; }
      .btn-primary { background: var(--brand); color: white; border-color: var(--brand); }
      .btn-primary:hover { filter: brightness(0.95); background: var(--brand); }
      .btn-success { background: var(--success); color: white; border-color: var(--success); }
      .btn-success:hover { filter: brightness(0.95); background: var(--success); }
      .badge { display:inline-block; padding:3px 10px; border-radius:999px; font-size:11px; font-weight: 500; }
      .badge.connected { background:#dcfce7; color:#166534; }
      .badge.connecting { background:#fff7ed; color:#92400e; }
      .badge.disconnected { background:#fee2e2; color:#991b1b; }
      .section { padding: 0 12px 10px; }
      .section-title { font-size: 13px; font-weight: 600; color: var(--text); margin: 12px 12px 8px; }
      .item { border: 1px solid var(--border); background:var(--card); border-radius: 8px; padding: 10px; margin: 8px 0; white-space: pre-wrap; word-break: break-word; font-size: 13px; }
      .item:hover { box-shadow: 0 2px 8px rgba(0,0,0,0.06); }
      .item-text { max-height: 60px; overflow: hidden; margin-bottom: 8px; }
      .actions { display: flex; gap: 6px; margin-top: 8px; }
      .actions button { padding: 4px 8px; font-size: 12px; }
      .muted { color: var(--muted); font-size: 12px; }
      #items { max-height: 300px; overflow: auto; }
      #logs { background: #0f172a; color:#cbd5e1; padding:8px; border-radius:6px; font-size: 11px; font-family: 'Courier New', monospace; line-height: 1.4; }
      .status-bar { display:flex; gap:8px; align-items:center; flex-wrap:wrap; padding: 8px 12px; background: var(--card); border-radius: 6px; margin: 8px 12px; }
      .empty-state { text-align: center; padding: 40px 20px; color: var(--muted); }
      .empty-state-icon { font-size: 48px; margin-bottom: 12px; }
    </style>
  </head>
  <body>
    <header>
      <h1>ðŸ”„ CopiMon</h1>
      <div class="toolbar">
        <button id="reconnect" title="Reconnect" class="btn-success">Connect</button>
        <button id="refresh" title="Refresh" class="btn-primary">Refresh</button>
      </div>
    </header>
    
    <div class="row">
      <input type="text" id="serverUrl" placeholder="Server URL" />
    </div>
    
    <div class="row">
      <input type="text" id="roomId" placeholder="Room ID" />
      <button id="save" class="btn-primary">Save</button>
    </div>
    
    <div class="row">
      <label style="display:flex; align-items:center; gap:8px; font-size:12px; color:var(--muted); cursor: pointer;">
        <input type="checkbox" id="useCtrlVOverlay" /> 
        <span>Open overlay on plain Ctrl/Cmd+V</span>
      </label>
    </div>
    
     <div class="status-bar">
      <span class="muted">Status:</span>
      <span id="wsState" class="badge disconnected">WS: unknown</span>
      <span id="permWrite" class="badge disconnected">clipboard-write: unknown</span>
      <span id="contentState" class="badge disconnected">content: unknown</span>
       <button id="enableSite" class="btn-success" style="margin-left:auto;">Enable on this site</button>
    </div>
    
    <div class="section">
      <div id="statusMessage" class="muted"></div>
    </div>
    
    <div class="section-title">ðŸ“‹ Clipboard History</div>
    <div id="items" class="section"></div>
    
    <div class="row" style="justify-content: space-between;">
      <button id="clearLogs">Clear Logs</button>
      <button id="requestClipboard">Request Permissions</button>
    </div>
    
    <div class="section-title">ðŸ“Š Logs</div>
    <div id="logs" class="section" style="max-height:200px; overflow:auto; white-space:pre-wrap;"></div>
    
    <script src="popup.js"></script>
  </body>
</html>